Corriger un fichier CSV contenant des caractÃ¨res mal affichÃ©s Ã  cause de problÃ¨mes d'encodage, en particulier des artefacts comme Ã°Å¸â€¡ÂªÃ°Å¸â€¡Â¸ (au lieu de ğŸ‡ªğŸ‡¸) ou Ã¢â‚¬â„¢ (au lieu de ').

ğŸ§© Ã‰tape par Ã©tape
1. Importation du module codecs
import codecs
Ce module permet de manipuler finement les encodages (utile si on veut contrÃ´ler ce qui se passe derriÃ¨re .encode() et .decode()).

2. DÃ©finition des noms de fichiers
input_file = "tweets_csv_2.csv"
output_file = "tweets_csv_utf8_corrige_final.csv"

input_file : le fichier original, corrompu

output_file : le nouveau fichier corrigÃ© qu'on va crÃ©er

3. Fonction double_decode(text)
def double_decode(text):
    current = text
    for _ in range(2):
        try:
            current = current.encode("latin1", errors="ignore").decode("utf-8", errors="ignore")
        except Exception:
            break
    return current


ğŸ’¡ But :
Corriger les caractÃ¨res corrompus en simulant deux passages d'encodage incorrect.

ğŸ” DÃ©tail :
current.encode("latin1", errors="ignore") :

On transforme le texte en bytes, en supposant quâ€™il avait Ã©tÃ© mal encodÃ© en latin1.

On ignore les caractÃ¨res qui ne passent pas (errors="ignore").

.decode("utf-8", errors="ignore") :

On redÃ©code ces bytes en UTF-8.

Cette opÃ©ration est faite jusquâ€™Ã  deux fois, car certains textes sont doublement corrompus (UTF-8 â†’ ISO-8859-1 â†’ UTF-8).

4. Lecture du fichier original
with open(input_file, "r", encoding="latin1", errors="replace") as f_in:
    lines = f_in.readlines()

On lit le fichier comme sâ€™il Ã©tait en ISO-8859-1 (latin1), ce qui permet dâ€™absorber les erreurs dâ€™affichage initiales.

errors="replace" remplace les caractÃ¨res problÃ©matiques par ï¿½ (mais on va essayer de les corriger ensuite).

5. CrÃ©ation du fichier corrigÃ©
with open(output_file, "w", encoding="utf-8") as f_out:
    for line in lines:
        cleaned = double_decode(line)
        f_out.write(cleaned)
Pour chaque ligne :

On appelle double_decode() pour essayer de corriger les caractÃ¨res mal encodÃ©s.

On Ã©crit la version corrigÃ©e dans le nouveau fichier en encodage UTF-8 propre.

6. Message de fin
print(f"âœ… Fichier corrigÃ© enregistrÃ© sous : {output_file}")
Confirmation que tout a fonctionnÃ© et que le fichier final est prÃªt Ã  Ãªtre utilisÃ© (par exemple dans Excel).

ğŸ¯ RÃ©sultat
Un fichier .csv qui :

Ne contient plus de Ãƒ, Ã°Å¸, Ã¢â‚¬â„¢, etc.

Est bien encodÃ© en UTF-8 (donc prÃªt pour Excel, Python, etc.)

Restaure les caractÃ¨res accentuÃ©s, Ã©mojis, symboles et apostrophes correctement
